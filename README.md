# Домашнее задание к лекции 4.«Tests»

### Задача №1. Unit-tests
При выполнении данного пункта домашнего задания в качестве тестируемой программы
было взято решение приложенное к самому заданию.

Исходный код самой программы не изменялся. Используемые в программе _input_ и
_print_ были замоканы при помощи _unittest.mock_. Сами же тесты используют _pytest_
как и во всех последующих заданиях.

В зависимости от конкретного кейса при тестировании проверялись:
* значения, возвращённые методами
* вывод результата на экран
* изменения внутри хранилища документов и полок

Тесты покрывают практически все имеющиеся значимые функции и в некоторых случаях
используют отдельно негативные сценарии.

Структура тестов описана внутри класса _TestApp_ модуля _test_app.py_.

### Задача №2. Автотест API Яндекса
При выполнении данного пункта домашнего задания в качестве тестируемой программы
было написано решение внутри класса _YaDiskCreateFolder_ (модуль _yadisk_create_folder_).
Данное решение содержит функцию, которая создаёт папку на Яндекс.Диск с именем, которое
вводит пользователь. Именно эта функция и являлась тестируемой.

Сами тесты описаны в модуле _test_yadisk_create_folder_ внутри класса _YaDiskCreateFolder_.
Здесь, как и ранее, используемый в функции _input_ был замокан.

Кейсы проверяли код ответа и его содержимое при возникновении различных ситуаций, 
возникающих при создании папки на Яндекс.Диск. К числу таких ситуаций относятся:
* успешное создание папки (код ответа - 201)
* неуспешное создание папки из-за дублирования имени (код ответа - 409)
* неуспешное создание папки из-за отсутствия авторизации (код ответа - 401)
* неуспешное создание папки из-за отсутствия имени папки (код ответа - 400)

После каждого из тестов происходило удаление созданной папки для того, чтобы
не захламлять Яндекс.Диск.

Токен для использования Яндекс.Диск располагается в переменной окружения, 
используется библиотека _python-dotenv_.

### Задача №3. Selenium
Данный пункт задания реализован посредством паттерна PageObject и представлен в 
отдельной директории _SeleniumYandex_, которая содержит:
* _conftest.py_ - фикстура, инициализирующая вебдрайвер, по факту — замена
  методов _setup_ и _teardown_. Здесь мы подготавливаем начальное состояние системы
  для тестирования, всё что перечислено до _yield_ (по сути только инициализация
  драйвера) будет выполняться перед каждым тестом, а всё что после (закрытие драйвера) 
  — после теста. Для простоты путь к файлу вебдрайвера задан в виде константы и 
  содержит ссылку на расположение файла на ПК.

* _base_selenium.py_ - модуль, определяющий необходимые методы работы с вебдрайвером,
  где также указана ссылка на тестовый URL.

* _selenium_yandexpages.py_ - модуль, содержащий класс для хранения локаторов
  элементов (_Elements_), а также класс _SeleniumHelper_ (наследник класса
  BaseSelenium из _base_selenium.py_), который реализует методы для взаимодействия
  со страницами.
  
* _test_selenium_yandex_authorize_ - модуль, где реализованы тесты. Каждый тестовый
  метод принимает фикстуру _browser_ и создаёт объект страницы из которого вызываются
  методы, описанные в _SeleniumHelper_ (_selenium_yandexpages.py_). В некоторых 
  местах были использованы тайм-ауты для того, чтобы страница успела загрузиться и 
  необходимый элемент уже присутствовал на ней. Тесты покрывают следующие сценарии:
  
* попытка логина с некорректными данными (невалидное имя пользователя - в качестве 
  невалидного имени генерировался случайный uuid)
  
* попытка логина без указания имени пользователя

* попытка логина с несуществующим именем пользователя

* попытка логина с неправильным паролем

* успешная попытка логина


### Allure

Для всех написанных тестов была добавлена возможность генерации отчётов в Allure.

Для запуска тестов и сохранения результатов необходимо использовать команду 
(в репозитории проекта будет создана папка _allure-results_):
* _py -m pytest --alluredir=allure-results_

Для генерации и открытия отчёта после выполнения предыдущей команды необходимо 
использовать:
* _allure serve allure-results_
